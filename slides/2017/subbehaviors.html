<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Subbehaviors</title>
<meta name="author" content="(Jay Kamat, Josh Ting)"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/reveal.js/3.0.0/css/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/reveal.js/3.0.0/css/theme/black.css" id="theme"/>


<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdn.jsdelivr.net/reveal.js/3.0.0/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><h1 class="title">Subbehaviors</h1>
</section>
<section>
<section id="slide-org0f332a0">
<h2 id="org0f332a0">Questions about Plays?</h2>
<ul>
<li>Topics Covered:
<ul>
<li>Python</li>
<li>State Machines</li>
<li>Play/Tactic/Skill Structure</li>

</ul></li>
<li>Last meeting was pretty dense
<ul>
<li>RoboCup is complicated</li>
<li>If you got it, great</li>
<li>If you didn't, great
<ul>
<li>We need you to ask questions when you don't understand something</li>

</ul></li>

</ul></li>
<li>And today, we're going into&#x2026;</li>

</ul>
</section>
</section>
<section>
<section id="slide-org2dfd360">
<h2 id="org2dfd360">Subbehaviors!</h2>
<ul>
<li>A behavior is a generic name for any skill, play, or tactic.</li>
<li>Last meeting we learned about Plays/Tactics/Skills
<ul>
<li>How do we put them together?</li>

</ul></li>
<li>Subbehaviors allow you to reuse our behaviors in many plays.
<ul>
<li>Example: We have <i>one</i> move play, used by kicker tactics, passing tactics, goalie, etc.</li>

</ul></li>

</ul>
</section>
<section id="slide-org683b0d4">
<h3 id="org683b0d4">Examples of Subbehaviors</h3>
<ul>
<li>Offense Play contains Passing Tactics, and Move Skills</li>
<li>Passing Tactic Contains Move and Kick Skills</li>

</ul>
</section>
<section id="slide-org797f0ab">
<h3 id="org797f0ab"><i>Behavior</i> Tree!</h3>
<div class="org-src-container">

<pre  class="src src-text"><code trim>Basic122::running
    Mark::running[robot=4]
        move(0.767296, 6.51286)
        endVelocity(0, 0)
        face(0.160718, 9.15305)
    PivotKick::capturing
        Capture::course_approach[robot=2]
            face(0.160718, 9.15305)
            avoidBall(-1)
            move(0.176939, 9.114)
            endVelocity(0, 0)
    Mark::running[robot=1]
        move(-0.829012, 6.03814)
        endVelocity(0, 0)
        face(0.160718, 9.15305)
</code></pre>
</div>
</section>
<section id="slide-orgccb7f63">
<h3 id="orgccb7f63"><i>Behavior</i> Tree! (cont.)</h3>
<div class="org-src-container">

<pre  class="src src-text"><code trim>Basic122::running
    Defense::defending
        SubmissiveDefender::marking
            Move::completed[robot=5]
                face(0.160718, 9.15305)
        SubmissiveDefender::marking
            Move::completed[robot=3]
                face(0.160718, 9.15305)
        SubmissiveGoalie::block
            Move::running[robot=0]
                face(0.160718, 9.15305)
                move(0.290916, 0.14)
                endVelocity(0, 0)
</code></pre>
</div>
</section>
</section>
<section>
<section id="slide-orgadfbe14">
<h2 id="orgadfbe14">How do I use subbehaviors?</h2>
<div class="outline-text-2" id="text-orgadfbe14">
</div>
</section>
<section id="slide-org1b476e7">
<h3 id="org1b476e7">Adding Subbehaviors</h3>
<div class="org-src-container">

<pre  class="src src-python"><code trim><span style="color: #598249;">self</span>.add_subbehavior(skill_object,
                     <span style="color: #15968D;">"Name of Subbehavior"</span>,
                     required=<span style="color: #15968D;">False</span> <span style="color: #598249;">or</span> <span style="color: #15968D;">True</span>
                     priority=10) <span style="color: #5e6263;"># </span><span style="color: #5e6263;">A higher number is higher priority</span>
</code></pre>
</div>
<ul>
<li>If adding a <code>complex behavior</code> or <code>single robot complex behavior</code>, don't pass in values for <code>required</code> or <code>priority</code></li>

</ul>
</section>
<section id="slide-org3a59f22">
<h3 id="org3a59f22">Removing Subbehaviors</h3>
<div class="org-src-container">

<pre  class="src src-python"><code trim><span style="color: #598249;">self</span>.remove_subbehavior(<span style="color: #15968D;">'string name'</span>)

<span style="color: #598249;">self</span>.remove_all_subbehaviors()
</code></pre>
</div>
</section>
<section id="slide-org0bf07d2">
<h3 id="org0bf07d2">Getting Subbehavior Plays</h3>
<div class="org-src-container">

<pre  class="src src-python"><code trim><span style="color: #2F7BDE;">a_subbheavior</span> = <span style="color: #598249;">self</span>.subbehavior_with_name(<span style="color: #15968D;">'string name'</span>)
</code></pre>
</div>
</section>
</section>
<section>
<section id="slide-org99b2b38">
<h2 id="org99b2b38">Real Examples</h2>
<div class="outline-text-2" id="text-org99b2b38">
</div>
</section>
<section id="slide-org9be0942">
<h3 id="org9be0942">CoordinatedPass Tactic</h3>
<div class="org-src-container">

<pre  class="src src-python"><code trim><span style="color: #598249;">def</span> <span style="color: #2F7BDE;">on_enter_running</span>(<span style="color: #598249;">self</span>):
    <span style="color: #2F7BDE;">receiver</span> = skills.pass_receive.PassReceive()
    <span style="color: #2F7BDE;">receiver.receive_point</span> = <span style="color: #598249;">self</span>.receive_point
    <span style="color: #598249;">self</span>.add_subbehavior(receiver,
                         <span style="color: #15968D;">'receiver'</span>,
                         required=<span style="color: #598249;">self</span>.receiver_required)

<span style="color: #598249;">def</span> <span style="color: #2F7BDE;">on_exit_running</span>(<span style="color: #598249;">self</span>):
    <span style="color: #598249;">self</span>.remove_subbehavior(<span style="color: #15968D;">'receiver'</span>)
</code></pre>
</div>
</section>
<section id="slide-org1e95bef">
<h3 id="org1e95bef">Line Up Tactic</h3>
<ul>
<li>First State Machine is set up, then:</li>

</ul>
<div class="org-src-container">

<pre  class="src src-python"><code trim><span style="color: #5e6263;"># </span><span style="color: #5e6263;">Triggered whenever the line changes</span>
<span style="color: #598249;">self</span>.remove_all_subbehaviors()
<span style="color: #598249;">for</span> i <span style="color: #598249;">in</span> <span style="color: #598249;">range</span>(6):
    <span style="color: #2F7BDE;">pt</span> = <span style="color: #598249;">self</span>._line.get_pt(0) + (<span style="color: #598249;">self</span>.diff * <span style="color: #598249;">float</span>(i))
    <span style="color: #598249;">self</span>.add_subbehavior(
        skills.move.Move(pt),
        name=<span style="color: #15968D;">"robot"</span> + <span style="color: #598249;">str</span>(i),
        required=<span style="color: #15968D;">False</span>,
        priority=6 - i)
</code></pre>
</div>

<div class="org-src-container">

<pre  class="src src-python"><code trim><span style="color: #598249;">def</span> <span style="color: #2F7BDE;">execute_running</span>(<span style="color: #598249;">self</span>):
    <span style="color: #598249;">for</span> i <span style="color: #598249;">in</span> <span style="color: #598249;">range</span>(6):
        <span style="color: #2F7BDE;">pt</span> = <span style="color: #598249;">self</span>._line.get_pt(0) + (<span style="color: #598249;">self</span>.diff * <span style="color: #598249;">float</span>(i))
        <span style="color: #598249;">self</span>.subbehavior_with_name(<span style="color: #15968D;">"robot"</span> + <span style="color: #598249;">str</span>(i))<span style="color: #2F7BDE;">.pos</span> = pt
</code></pre>
</div>
</section>
</section>
<section>
<section id="slide-orgb114bca">
<h2 id="orgb114bca">RoboCup Pro Tip</h2>
<ul>
<li>Find some code doing something like what you want</li>
<li>Tweak it until it works</li>
<li>It's less effective than working everything out, but it's great for beginners!</li>

</ul>

</section>
</section>
<section>
<section id="slide-org5557bb3">
<h2 id="org5557bb3">Assignment</h2>
<ul>
<li>Create a Triangle Pass Play</li>
<li>Move 3 Robots into a triangle formation, and pass between them.</li>
<li>Starter code is in <code>soccer/gameplay/plays/skel/triangle_pass.py</code> (same as last time).</li>
<li>Move it to <code>soccer/gameplay/plays/testing/triangle_pass.py</code> to begin.</li>

</ul>
</section>
<section id="slide-org92e4d97">
<h3 id="org92e4d97">Tips</h3>
<ol>
<li>Use Move Skills to move your robots to the triangle initially</li>
<li>Use the CoordinatedPass Tactic to pass between, setting receive points as sides of the triangle</li>
<li>At a bare minimum, I would make setup and passing states. You may want to have a state for every side of the triangle (or not).</li>

</ol>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/reveal.js/3.0.0/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'https://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
]
});
</script>
</body>
</html>
